++ Канал Событий Питания И Сеанса Пользователя

+++Реализация
Сейчас в главном окне Оператор эти функции выполняет класс событий питания и сеанса пользователя SystemEventCanalizator.
Это разгрузило класс окна от экспериментального кода канала.

* Класс Движка содержит функцию СобытиеПитанияИСеанса(SystemStateCode code), которая принимает только код события.
* Код класса SystemEventCanalizator принимает события:
    * SystemEvents.PowerModeChanged  - изменения параметров питания компьютера.
    * SystemEvents.TimeChanged - изменение системного времени операционной системы.
    * SystemEvents.SessionEnding - уведомление о предстоящем завершении сеанса пользователя.
    * SystemEvents.SessionSwitch - уведомление о временной блокировке сеанса пользователя.
* Эти события переводятся в коды событий канала событий питания и сеанса пользователя.
Перевод производится так, что события отправляются в канал только когда соответствующее состояние изменяется.
    * Из PowerModeChanged получаются события питания:
        * Компьютер засыпает:  SystemSuspend.
        * Компьютер просыпается: SystemResume
        * Компьютер был отключен от питающей сети: PowerLineStatus.Offline.
        * Компьютер был подключен к питающей сети: PowerLineStatus.Online.
        * Батарея начала заряжаться: BatteryChargingOn.
        * Батарея перестала заряжаться: BatteryChargingOff.
        * Батарея имеет достаточный заряд: BatteryStatusHigh.
        * Батарея имеет недостаточный заряд: BatteryStatusLow
        * Батарея имеет критически низкий заряд: BatteryStatusCritical
        * Батарея отсутствует: BatteryStatusNoBattery
        * Состояние батареи неизвестно: BatteryStatusUnknown
    * Из TimeChanged получается событие перевода времени: ClockTimeChanged.
    * Из SessionEnding получается событие причины завершения сеанса: UserLogoff и SystemShutdown.
    * Из SessionSwitch получаются события блокировки сеанса: UserSessionLocked и UserSessionUnlocked.

* Когда заряд батареи ноутбука достигает критического уровня, он подаетпредупреждающие сигналы и затем засыпает. При этом сообщение SystemSuspend не выдается. Просто останавливается выполнение программ. При последующем пробуждении по кнопке питания, выдается сообщение ClockTimeChanged, поскольку новое значение часов загружается из БИОС. Затем выдается сообщение SystemResume. О причине засыпания можно узнать по совокупности факторов, но пока я не вижу смысла узнавать это. Уснул и уснул.
Затем выдается сообщение UserSessionLocked и показывается экран приветствия - логина. Когда пользователь кликает по иконке аккаунта, выдается сообщение UserSessionUnlocked. После этого операционная система показывает Рабочий стол и срабатывает Автозагрузка, вызывая все приложения, прописанные в ней ярлыками.
* Когда компьютер засыпает по команде пользователя, выдается событие SystemSuspend и все последующие при пробуждении.
* Когда компьютер выключается или перезагружается по команде пользователя, выдается событие SystemShutdown. Затем приложения и вообще процессы завершаются системой. Отменить тут ничего нельзя. Есть 20 секунд на завершение дел, или меньше. 
* Когда пользователь выходит из аккаунта, выдается событие UserLogoff. Затем приложения и вообще процессы завершаются системой. Отменить тут ничего нельзя. Есть 20 секунд на завершение дел, или меньше.  